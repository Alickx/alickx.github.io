(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{409:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("阅读掘金小册 Java 并发编程后的读后总结。")]),s._v(" "),a("h2",{attrs:{id:"_1-回顾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-回顾"}},[s._v("#")]),s._v(" 1. 回顾")]),s._v(" "),a("ol",[a("li",[s._v("经典的i++问题")]),s._v(" "),a("li",[s._v("程序和Cpu之间的协作关系")]),s._v(" "),a("li",[s._v("Cpu的几大模块")]),s._v(" "),a("li",[s._v("寄存器和程序之间的关系")]),s._v(" "),a("li",[s._v("临界区")]),s._v(" "),a("li",[s._v("信号量")]),s._v(" "),a("li",[s._v("管程和其三大模型")])]),s._v(" "),a("h2",{attrs:{id:"_2-学习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-学习"}},[s._v("#")]),s._v(" 2. 学习")]),s._v(" "),a("h3",{attrs:{id:"_1-经典的i-问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-经典的i-问题"}},[s._v("#")]),s._v(" 1. 经典的i++问题")]),s._v(" "),a("p",[s._v("在开章作者给出了一段代码，通过CountDownLatch模拟并发线程执行加操作。下面贴上这段代码。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThreadDemo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" j "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IncrTask")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Runnable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),s._v(" start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),s._v(" end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IncrTask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),s._v(" start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),s._v(" end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("end "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("await")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    j"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("countDown")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),s._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),s._v(" end "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CountDownLatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),s._v(" t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IncrTask")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("countDown")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("await")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"result is :"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" j"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("p",[s._v("在Idea上执行一下这段代码试试看。有概率获得数值会低于10000。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.llwstu.com/img/202208271437497.png",alt:"image-20220827143709293"}})]),s._v(" "),a("p",[s._v("这里之所以低于10000是因为这里i++操作包含了三个操作，一个是读取数值，第二个是进行增加，第三个是将增加后的数值设置回原先的内存地址当中。其中有可能在你读取数值后，其他线程对这个变量进行的增加并比第一个线程"),a("strong",[s._v("先一步设置回原先的内存地址当中")]),s._v("。这就会导致，你设置的值是旧值，所以会发生最终结果会少于10000的情况出现。")]),s._v(" "),a("h3",{attrs:{id:"_2-程序与cpu的协作关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-程序与cpu的协作关系"}},[s._v("#")]),s._v(" 2. 程序与cpu的协作关系")]),s._v(" "),a("p",[s._v("Cpu中存在寄存器，控制器，运算器和时钟。其中寄存器是我们最需要关心的地方，因为其主要存储了从内存中加载的数据。寄存器的读写速度比内存高了不知道多少个级别，所以需要L1,L2,L3缓存来存储这些数据。")]),s._v(" "),a("p",[s._v("其实我们在业务中运用到的二级缓存，三级缓存的思想也是参考计算机硬件设计思想的。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.llwstu.com/img/202208271448204.webp",alt:"image.png"}})]),s._v(" "),a("h3",{attrs:{id:"_3-cpu的几大模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-cpu的几大模块"}},[s._v("#")]),s._v(" 3. Cpu的几大模块")]),s._v(" "),a("p",[s._v("上面就列出了，Cpu主要的模块有寄存器，控制器，时钟，运算器。其中寄存器又分为两大类，分别是"),a("code",[s._v("存储内存地址类寄存器")]),s._v("和"),a("code",[s._v("存储非内存地址寄存器")]),s._v("。这两大类下面又有这些小类。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.llwstu.com/img/202208271451193.webp",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"_4-寄存器和程序之间的关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-寄存器和程序之间的关系"}},[s._v("#")]),s._v(" 4. 寄存器和程序之间的关系")]),s._v(" "),a("p",[s._v("举刚才的i++的例子，我们"),a("code",[s._v("编写好代码")]),s._v("，代码首先会持久化到"),a("code",[s._v("硬盘")]),s._v("上，然后运行的时候，我们会编译这段代码，从硬盘中读取该代码的"),a("code",[s._v("后缀为java")]),s._v("的文件，这个文件就是纯天然无污染的我们写的代码文件，然后通过"),a("code",[s._v("javac")]),s._v("命令编译生成class文件，即"),a("code",[s._v("字节码")]),s._v("文件，然后通过JIT编译再将字节码文件编译成"),a("code",[s._v("机器码")]),s._v("。")]),s._v(" "),a("p",[s._v("上面所使用到的javac指令还有JIT编译器其实都是属于Java编译器的一个大类。 先将java代码编译成字节码，再将字节码编译成机器码。 Java也属于"),a("strong",[s._v("半编译半解释")]),s._v("的语言。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.llwstu.com/img/202208271504427.webp",alt:"image.png"}})]),s._v(" "),a("p",[s._v("机器码存放的"),a("strong",[s._v("地址")]),s._v("会被放到一种叫做"),a("strong",[s._v("程序计数器")]),s._v("的寄存器中，之后"),a("strong",[s._v("控制器")]),s._v("会到根据程序计数器的地址去读取相关的机器指令，并且将指令读取给"),a("strong",[s._v("运算器")]),s._v("进行计算。当运行结束之后，"),a("strong",[s._v("程序计数器的地址就会刷新，让控制器去加载新内存地址的指令给到运算器。")])]),s._v(" "),a("p",[s._v("最后面的刷新和加载新地址，其实也就对应了我们i++操作中，读取地址，进行修改，设置回去。")]),s._v(" "),a("h3",{attrs:{id:"_5-临界区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-临界区"}},[s._v("#")]),s._v(" 5. 临界区")]),s._v(" "),a("p",[s._v("在操作系统的课程上，我了解到临界区这一个名词。当时背到的解释是访问临界资源的代码就叫临界区。那这个临界资源其实就是指共享资源，当某一时刻同时有多个进程或者线程访问某一临界区的时候，就可能会出现数据安全问题。")]),s._v(" "),a("h3",{attrs:{id:"_6-信号量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-信号量"}},[s._v("#")]),s._v(" 6. 信号量")]),s._v(" "),a("p",[s._v("在操作系统课程上，我也学习到信号量这一个名词，信号量是线程或进程间通信的一种方式。文章中也说到是一种设计思想，本质可以理解为一个整形的数字，对于这个数字的操作，就有熟悉的PV操作。")]),s._v(" "),a("p",[s._v("sem 即 信号量")]),s._v(" "),a("p",[s._v("P(): sem - 1，如果sem为0则进入等待状态")]),s._v(" "),a("p",[s._v("v(): sem + 1，如果sem为0则同时会唤醒一个等待的P")]),s._v(" "),a("p",[s._v("信号量的操作是具有"),a("code",[s._v("原子性")]),s._v("的，原子性指的就是全部操作要不全部成功，要不全部失败，不会出现一些成功，一些失败。这里的实现是依赖于操作系统的底层，即"),a("code",[s._v("原语")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.llwstu.com/img/202208271515427.webp",alt:"image.png"}})]),s._v(" "),a("h3",{attrs:{id:"_7-管程和其三大模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-管程和其三大模型"}},[s._v("#")]),s._v(" 7.管程和其三大模型")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("管程")]),s._v(" 可以理解为是基于信号量的基础上做了一层封装，专门用于访问一些共享变量的函数，让其调用方使用起来更加简单和清晰，它的作用是"),a("strong",[s._v("一次只允许有一个线程访问临界期，如果同时有太多个访问，则将多余的访问挂起")]),s._v("。")]),s._v(" "),a("p",[a("strong",[s._v("这里需要注意的是，信号量的应用主要是基于操作系统层面中，而管程的提出")]),s._v(" "),a("strong",[s._v("，")]),s._v(" "),a("strong",[s._v("则是用在了语言的场景中，它主要是专门针对语言中的并发场景而设计的，从而简化了一些语言层面的实现逻辑。")])]),s._v(" "),a("p",[s._v("例如Java内部对于并发模块的实现 wait()、notify()、notifyAll() 这些函数就是采用了管程技术来控制的。")])]),s._v(" "),a("p",[s._v("说白了，其实就是在我们使用的高级语言的层面对底层PV操作进行了封装，让我们可以通过简单的函数就可以操作。这就叫管程。")]),s._v(" "),a("p",[s._v("那还有一个叫"),a("code",[s._v("协程")]),s._v("的东西呢？ 协程是一个在线程之上，在进程之下的一个东西。当我们有多个请求的时候，我们需要起对应请求数量的线程来处理，线程之间的切换同时也要经过用户态和内核态。可是协程可以通过复用的方式，不需要多个线程，只需要一个线程就可以执行。")]),s._v(" "),a("p",[s._v("下面是廖雪峰官网的解释: "),a("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/1016959663602400/1017968846697824",target:"_blank",rel:"noopener noreferrer"}},[s._v("廖雪峰的官方网站 - 协程"),a("OutboundLink")],1)]),s._v(" "),a("blockquote",[a("p",[s._v("最大的优势就是协程极高的执行效率。因为子程序切换不是线程切换，而是由程序自身控制，因此，没有线程切换的开销，和多线程比，线程数量越多，协程的性能优势就越明显。")]),s._v(" "),a("p",[s._v("第二大优势就是不需要多线程的锁机制，因为只有一个线程，也不存在同时写变量冲突，在协程中控制共享资源不加锁，只需要判断状态就好了，所以执行效率比多线程高很多。")]),s._v(" "),a("p",[s._v("因为协程是一个线程执行，那怎么利用多核CPU呢？最简单的方法是多进程+协程，既充分利用多核，又充分发挥协程的高效率，可获得极高的性能。")])]),s._v(" "),a("p",[s._v("管程的组成：")]),s._v(" "),a("ul",[a("li",[s._v("一把锁")]),s._v(" "),a("li",[s._v("0或者多个条件变量")])]),s._v(" "),a("p",[a("strong",[s._v("一把锁：")]),s._v(" 管程为了保证对于共享资源的访问一次只能有一个元素，所以才引入了锁的机制，没有抢到锁的请求则需要进入到"),a("strong",[s._v("锁的等待队列，主要是为了确保互斥性。")])]),s._v(" "),a("p",[a("strong",[s._v("0或者多个条件变量：")]),s._v(" 当获取到了锁的请求进入到了临界区模块中之后，有可能还需要做多个条件的判断，如果没有满足其中的某一条条件则需要进入到"),a("strong",[s._v("条件的等待队列")]),s._v("中。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img.llwstu.com/img/202208271526213.webp",alt:"img"}})]),s._v(" "),a("p",[s._v("当 Condition 调用了 signal() 函数的时候，会唤醒等待队列中的一个挂起线程，那么就会产生同时有两个线程访问到了临界区的共享资源，一个是当前触发 signal 函数的线程，一个是刚从挂起状态被唤醒的线程，这种情况下该如何处理呢？")]),s._v(" "),a("p",[s._v("业界提出了三种管程的模型，三大模型则分别是"),a("code",[s._v("Hansen")]),s._v(","),a("code",[s._v("Hoare")]),s._v(","),a("code",[s._v("Mesa")]),s._v("模型。模拟一个场景，被挂起的线程为A，调用signal的线程为B")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lock")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Acquire")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//等待锁可用，然后抢占")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lock")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Release")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//释放锁，唤醒等待队列中的线程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Wait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//释放当前锁，进入睡眠状态，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Signal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//当某个条件满足的时候，就会唤醒等待队列中线程")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("抢到锁的线程想要主动释放锁，那么就需要主动地调用wait()方法。")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://img.llwstu.com/img/202208271535519.webp",alt:"image.png"}}),s._v(" "),a("ol",[a("li",[s._v("Hansen ： 让A立即执行，B则处于睡眠状态，在等待A放行之后才继续让B执行。")]),s._v(" "),a("li",[s._v("Horare ： 等待B完全执行完毕后，才允许让被唤醒的A继续执行。")]),s._v(" "),a("li",[s._v("Mesa : B在执行Signal后不需要担心A的任何事情，B可以继续正常执行，A则会被重新放入到等待队列去参与抢占的行为。")])])])}),[],!1,null,null,null);a.default=e.exports}}]);